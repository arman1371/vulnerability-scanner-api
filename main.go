package main

import (
	"github.com/arman1371/vulnerability-scanner-api/handlers"
	"github.com/arman1371/vulnerability-scanner-api/log"
	"github.com/gin-gonic/gin"
	"github.com/spf13/viper"
)

var configPath string = "config/trivy-default.yaml"

func main() {
	err := initConfig()
	if err != nil {
		log.Infof("Error in reading config file. %v", err)
	}

	router := gin.Default()
	router.POST("scan", handlers.Scan)

	_ = router.Run(":8081")
}

func initConfig() error {
	viper.SetConfigFile(configPath)
	viper.SetConfigType("yaml")
	return viper.ReadInConfig()
}
