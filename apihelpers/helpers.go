package apihelpers

import (
	"net/http"

	"github.com/aquasecurity/trivy/pkg/types"
	"github.com/arman1371/vulnerability-scanner-api/log"
	apiresources "github.com/arman1371/vulnerability-scanner-api/resources/api"
	"github.com/gin-gonic/gin"
)

func ErrorResponse(c *gin.Context, status int, err error) {
	log.Errorf("Error in running request. %v", err)

	errorMsg := "Internal server error."
	if status/100 == 4 {
		errorMsg = err.Error()
	}
	c.JSON(status, apiresources.ResponseBody{Error: errorMsg})
}

func SuccessResponse(c *gin.Context, report *types.Report) {
	c.JSON(http.StatusOK, apiresources.ResponseBody{Report: report})
}
